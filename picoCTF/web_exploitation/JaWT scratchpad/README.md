# JaWT Scratchpad

## Description

Check the admin scratchpad! https://jupiter.challenges.picoctf.org/problem/61864/ or http://jupiter.challenges.picoctf.org:61864

## Hint(s)

1. What is that cookie?
2. Have you heard of JWT?


## Writeup 
By opening the url and playing with the website and inputting a name for it to log us in. We'll be using "Galaxy" here.

After doing so, you will be redirected to a page where youre "logged in" and can use the scratch pad. 
But if we look at the cookies, we can see a cookie named "**jwt**".

Going to jwt.io and trying to decode the cookie gives us this
```
{
  "user": "Galaxy"  
}
```
Now, we know that we need to find the secret key. If we look at the bottom of the website it mentions the name "John" which hints john the ripper, or in other words, brute forcing.

I found using john the ripper to be problematic since it doesnt support JWT and you have to use jwtcrack to convert the cookie so that it can be used by john the ripper.

Instead, i used hashcat which was way simpler and easier.

By using: 
``` 
$ hashcat -h |grep JWT
```
We get:
```
16500 | JWT (JSON Web Token) 
```
So now we know that the hash type is 16500 (we can also see this [here](https://hashcat.net/wiki/doku.php?id=hashcat))

We now have to store the cookie in a file thats how hashcat reads input, i stored my cookie in `tmp/jwt.hash` 

All that we have to do now is to bruteforce the cookie using a wordlist. Its best to always try rockyou.txt before trying other wordlists :
```
$ hashcat -m 16500 /tmp/jwt.hash /usr/share/wordlists/rockyou.txt 
```
After a few seconds, hashcat returns:
```
yJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiZ2FsYXh5In0.hc_Hrsq_psWftVU4lK3K17s9AL_x4ChaRG7F5HhyyrE:ilovepico
                                                 
Session..........: hashcat
Status...........: Cracked
Hash.Name........: JWT (JSON Web Token)
Hash.Target......: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiZ2...HhyyrE
Time.Started.....: Sun Jul  3 07:40:15 2022 (17 secs)
Time.Estimated...: Sun Jul  3 07:40:32 2022 (0 secs)
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:   462.1 kH/s (3.85ms) @ Accel:1024 Loops:1 Thr:1 Vec:4
Recovered........: 1/1 (100.00%) Digests
Progress.........: 7397376/14344385 (51.57%)
Rejected.........: 0/7397376 (0.00%)
Restore.Point....: 7393280/14344385 (51.54%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidates.#1....: iloverobert!!! -> ilovemymum64.
```
The secret key is found! `ilovepico`

Now we create our payload using [jwt.io](jwt.io)
```
{
  "user": "admin"
}
```
And we add the secret key:
```
HMACSHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
ilovepico
)
```
Then all thats left to do is go to the URL and change our cookie to the forged cookie, and bam. 

the flag is : `picoCTF{jawt_was_just_what_you_thought_1ca14548}`

# 
